import{i as t,y as e}from"../../lit-element-2409d5fe.js";import{m as s,s as i}from"../../lit-localize-763e4978.js";import{o}from"../../map-c0e24c36.js";import{c as r}from"../../repeat-1a2b8966.js";import{l}from"../../if-defined-11ddebeb.js";import{o as a}from"../../class-map-8d921948.js";import{D as n}from"../../dt-base.js";import"../../directive-de55b00a.js";window.customElements.define("dt-list",class extends n{static get styles(){return t`:host{--number-of-columns:7;font-family:var(--dt-list-font-family,var(--font-family));font-size:var(--dt-list-font-size,15px);font-weight:var(--dt-list-font-weight,300);line-height:var(--dt-list-line-height,1.5);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.section{container-type:inline-size;background-color:var(--dt-list-background-color,#fefefe);border:1px solid var(--dt-list-border-color,#f1f1f1);border-radius:var(--dt-list-border-radius,10px);box-shadow:var(--dt-list-box-shadow,0 2px 4px rgb(0 0 0 / 25%));padding:var(--dt-list-section-padding,1rem)}.header{display:flex;justify-content:flex-start;align-items:baseline;gap:var(--dt-list-header-gap,1.5em);flex-wrap:wrap}.section-header{color:var(--dt-list-header-color,var(--primary-color));font-size:1.5rem;display:inline-block;text-transform:capitalize}.toggleButton{color:var(--dt-list-header-color,var(--primary-color));font-size:1rem;background:0 0;border:var(--dt-list-toggleButton,.1em solid rgb(0 0 0 / .2));border-radius:.25em;padding:.25em .5em;cursor:pointer}.toggleButton svg{height:.9rem;transform:translateY(-2px);vertical-align:bottom;width:1rem;fill:var(--dt-list-header-color,var(--primary-color));stroke:var(--dt-list-header-color,var(--primary-color))}.list_action_section{background-color:var(--dt-list-action-section-background-color,#ecf5fc);border-radius:var(--dt-list-border-radius,10px);margin:var(--dt-list-action-section-margin,30px 0);padding:var(--dt-list-action-section-padding,20px)}.list_action_section_header{display:flex;flex-direction:row;justify-content:space-between}.close-button{outline:0;font-size:2.5em;line-height:1;color:var(--dt-list-action-close-button,var(--inactive-color));background:0 0;border:none;cursor:pointer}.fieldsList{list-style-type:none;column-count:1}.list-field-picker-item{list-style-type:none}.list-field-picker-item input{margin:1rem}.list-field-picker-item .dt-icon{height:var(--dt-list-field-picker-icon-size,1rem);width:var(--dt-list-field-picker-icon-size,1rem)}table{display:grid;border:1px solid var(--dt-list-border-color,#f1f1f1);border-top:0;border-collapse:collapse;min-width:100%;grid-template-columns:1fr}table td:last-child{border-bottom:1px solid var(--dt-list-border-color,#f1f1f1);padding-bottom:2rem}tbody,tr{display:contents}thead{display:none}tr{cursor:pointer}tr:nth-child(2n + 1){background:#f1f1f1}tr:hover{background-color:var(--dt-list-hover-background-color,#ecf5fc)}tr a{color:var(--dt-list-link-color,var(--primary-color))}.column-name{pointer-events:none;font-size:15px;font-weight:700}#sort-arrows{grid-template-columns:4fr 1fr;display:flex;flex-direction:column;height:1em;justify-content:space-evenly}th.all span.sort-arrow-up{border-color:transparent transparent var(--dt-list-sort-arrow-color,#dcdcdc) transparent;border-style:solid;border-width:0 .3em .3em .3em}th.all span.sort-arrow-down{content:'';border-color:var(--dt-list-sort-arrow-color,#dcdcdc) transparent transparent;border-style:solid;border-width:.3em .3em 0}th.all span.sort-arrow-up.sortedBy{border-color:transparent transparent var(--dt-list-sort-arrow-color-highlight,#41739c) transparent}th.all span.sort-arrow-down.sortedBy{border-color:var(--dt-list-sort-arrow-color-highlight,#41739c) transparent transparent}td{border:0;grid-column:1/span 3;padding-inline-start:1em}td::before{content:attr(title) ': ';padding-inline-end:1em}td.no-title{grid-column:1/span 3}td.line-count{padding-block-start:.8em;padding-inline-start:1em}td.no-title::before{content:'';padding-inline-end:.25em}td.bulk_edit_checkbox,th.bulk_edit_checkbox{grid-column:1/auto;padding:0;width:0}.bulk_edit_checkbox input{display:none;margin:0}.bulk_editing .bulk_edit_checkbox{grid-column:1/auto;padding:0;width:auto}.bulk_editing .bulk_edit_checkbox input{display:initial}ul{margin:0;padding:0}ul li{list-style-type:none}input[type=checkbox]{margin:1rem}table thead th,table tr td{padding:.5333333333rem .6666666667rem .6666666667rem}::slotted(svg){fill:var(--fav-star-not-selected-color,#c7c6c1)}.icon-star{fill:var(--fav-star-not-selected-color,#c7c6c1);margin:0}.icon-star.selected{fill:var(--fav-star-selected-color,#ffc105)}@media (min-width:650px){.fieldsList{column-count:2}table{grid-template-columns:minmax(0,0fr) minmax(32px,.25fr) minmax(32px,.25fr) repeat(var(--number-of-columns,6),minmax(50px,1fr))}table.bulk_editing{grid-template-columns:minmax(32px,.25fr) minmax(32px,.25fr) minmax(32px,.25fr) repeat(var(--number-of-columns,6),minmax(50px,1fr))}thead{display:contents}th{position:sticky;top:0;background:var(--dt-list-header-background-color,var(--dt-tile-background-color,#fefefe));text-align:start;justify-self:start;font-weight:400;font-size:1.1rem;color:var(--dt-list-header-color,#0a0a0a);white-space:pre-wrap;display:grid;place-items:center;grid-template-columns:2fr 1fr}th:last-child{border:0}td{display:flex;align-items:center;grid-column:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:.5rem;padding-bottom:.5rem;padding-inline-start:0;color:var(--text-color-mid);border-bottom:1px solid var(--dt-list-border-color,#f1f1f1)}td::before{content:'';display:none}td.no-title{grid-column:auto}}.btn{-webkit-appearance:none;border:1px solid transparent;border-radius:5px;cursor:pointer;display:inline-block;font-family:inherit;font-size:.9rem;line-height:1;margin:0!important;text-align:center;-webkit-transition:background-color .25s ease-out,color .25s ease-out;transition:background-color .25s ease-out,color .25s ease-out;vertical-align:middle}.btn.btn-primary{background-color:#3f729b;color:#fefefe;border-radius:5px}.btn.btn-primary:focus,.btn.btn-primary:hover{background-color:#366184;color:#fefefe}.text-center{text-align:center}.btn.btn-primary .dt-button{margin:0;border-radius:5px}@media (min-width:950px){.fieldsList{column-count:3}}@media (min-width:1500px){.fieldsList{column-count:4}}`}static get properties(){return{postType:{type:String},postTypeLabel:{type:String},posttypesettings:{type:Object,attribute:!0},posts:{type:Array},total:{type:Number},columns:{type:Array},sortedBy:{type:String},loading:{type:Boolean,default:!0},offset:{type:Number},showArchived:{type:Boolean,default:!1},showFieldsSelector:{type:Boolean,default:!1},showBulkEditSelector:{type:Boolean,default:!1},nonce:{type:String},payload:{type:Object},favorite:{type:Boolean},initialLoadPost:{type:Boolean,default:!1},loadMore:{type:Boolean,default:!1},headerClick:{type:Boolean,default:!1}}}constructor(){super(),this.sortedBy="name",this.payload={sort:this.sortedBy,overall_status:["-closed"],fields_to_return:this.sortedColumns},this.initalLoadPost=!1,this.initalLoadPost||(this.posts=[],this.limit=100)}firstUpdated(){this.postTypeSettings=window.post_type_fields,this.sortedColumns=this.columns.includes("favorite")?["favorite",...this.columns.filter((t=>"favorite"!==t))]:this.columns,this.style.setProperty("--number-of-columns",this.columns.length-1)}async _getPosts(t){const e=await new CustomEvent("dt:get-data",{bubbles:!0,detail:{field:this.name,postType:this.postType,query:t,onSuccess:t=>{this.initalLoadPost&&this.loadMore&&(this.posts=[...this.posts,...t],this.postsLength=this.posts.length,this.total=t.length,this.loadMore=!1),this.initalLoadPost||(this.posts=[...t],this.offset=this.posts.length,this.initalLoadPost=!0,this.total=t.length),this.headerClick&&(this.posts=t,this.offset=this.posts.length,this.headerClick=!1),this.total=t.length},onError:t=>{console.warn(t)}}});this.dispatchEvent(e)}_headerClick(t){const e=t.target.dataset.id;this.sortedBy===e?e.startsWith("-")?this.sortedBy=e.replace("-",""):this.sortedBy=`-${e}`:this.sortedBy=e,this.payload={sort:this.sortedBy,overall_status:["-closed"],limit:this.limit,fields_to_return:this.columns},this.headerClick=!0,this._getPosts(this.payload)}static _rowClick(t){window.open(t,"_self")}_bulkEdit(){this.showBulkEditSelector=!this.showBulkEditSelector}_fieldsEdit(){this.showFieldsSelector=!this.showFieldsSelector}_toggleShowArchived(){if(this.showArchived=!this.showArchived,this.headerClick=!0,this.showArchived){const{overall_status:t,offset:e,...s}=this.payload;this.payload=s}else this.payload.overall_status=["-closed"];this._getPosts(this.payload)}_sortArrowsClass(t){return this.sortedBy===t?"sortedBy":""}_sortArrowsToggle(t){return this.sortedBy!==`-${t}`?`-${t}`:t}_headerTemplate(){return this.postTypeSettings?e`<thead><tr><th id="bulk_edit_master" class="bulk_edit_checkbox"><input type="checkbox" name="bulk_send_app_id" id="bulk_edit_master_checkbox"></th><th class="no-title line-count"></th>${o(this.sortedColumns,(t=>{const s="favorite"===t;return e`<th class="all" data-id="${this._sortArrowsToggle(t)}" @click="${this._headerClick}"><span class="column-name">${s?null:this.postTypeSettings[t].name}</span> ${s?"":e`<span id="sort-arrows"><span class="sort-arrow-up ${this._sortArrowsClass(t)}" data-id="${t}"></span> <span class="sort-arrow-down ${this._sortArrowsClass(`-${t}`)}" data-id="-${t}"></span></span>`}</th>`}))}</tr></thead>`:null}_rowTemplate(){if(this.posts&&Array.isArray(this.posts)){const t=this.posts.map(((t,s)=>this.showArchived||!this.showArchived&&"closed"!==t.overall_status?e`<tr class="dnd-moved" data-link="${t.permalink}" @click="${()=>this._rowClick(t.permalink)}"><td class="bulk_edit_checkbox no-title"><input type="checkbox" name="bulk_edit_id" .value="${t.ID}"></td><td class="no-title line-count">${s+1}.</td>${this._cellTemplate(t)}</tr>`:null)).filter((t=>null!==t));return t.length>0?t:e`<p>No contacts available</p>`}return null}formatDate(t){const e=new Date(t);return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(e)}_cellTemplate(t){return o(this.sortedColumns,(s=>{if(["text","textarea","number"].includes(this.postTypeSettings[s].type))return e`<td dir="auto" title="${this.postTypeSettings[s].name}">${t[s]}</td>`;if("date"===this.postTypeSettings[s].type)return e`<td dir="auto" title="${this.postTypeSettings[s].name}">${this.formatDate(t[s].formatted)}</td>`;if("user_select"===this.postTypeSettings[s].type&&t[s]&&t[s].display)return e`<td dir="auto" title="${this.postTypeSettings[s].name}">${l(t[s].display)}</td>`;if("key_select"===this.postTypeSettings[s].type&&t[s]&&(t[s].label||t[s].name))return e`<td dir="auto" title="${this.postTypeSettings[s].name}">${t[s].label||t[s].name}</td>`;if("multi_select"===this.postTypeSettings[s].type||"tags"===this.postTypeSettings[s].type&&t[s]&&t[s].length>0)return e`<td dir="auto" title="${this.postTypeSettings[s].name}"><ul>${o(t[s],(t=>e`<li>${this.postTypeSettings[s].default[t].label}</li>`))}</ul></td>`;if("location"===this.postTypeSettings[s].type||"location_meta"===this.postTypeSettings[s].type)return e`<td dir="auto" title="${this.postTypeSettings[s].name}">${l(t[s].label)}</td>`;if("communication_channel"===this.postTypeSettings[s].type)return e`<td dir="auto" title="${this.postTypeSettings[s].name}">${l(t[s].value)}</td>`;if("connection"===this.postTypeSettings[s].type)return e`<td dir="auto" title="${this.postTypeSettings[s].name}">${l(t[s].value)}</td>`;if("boolean"===this.postTypeSettings[s].type){if("favorite"===s)return e`<td dir="auto" title="${this.postTypeSettings[s].name}"><dt-button id="favorite-button-${t.ID}" label="favorite" title="favorite" type="button" posttype="contacts" context="star" .favorited="${!!t.favorite&&t.favorite}" .listButton="${!0}"><svg class="${a({"icon-star":!0,selected:t.favorite})}" height="15" viewBox="0 0 32 32"><path d="M 31.916 12.092 C 31.706 11.417 31.131 10.937 30.451 10.873 L 21.215 9.996 L 17.564 1.077 C 17.295 0.423 16.681 0 16 0 C 15.318 0 14.706 0.423 14.435 1.079 L 10.784 9.996 L 1.546 10.873 C 0.868 10.937 0.295 11.417 0.084 12.092 C -0.126 12.769 0.068 13.51 0.581 13.978 L 7.563 20.367 L 5.503 29.83 C 5.354 30.524 5.613 31.245 6.165 31.662 C 6.462 31.886 6.811 32 7.161 32 C 7.463 32 7.764 31.915 8.032 31.747 L 16 26.778 L 23.963 31.747 C 24.546 32.113 25.281 32.08 25.834 31.662 C 26.386 31.243 26.645 30.524 26.494 29.83 L 24.436 20.367 L 31.417 13.978 C 31.931 13.51 32.127 12.769 31.916 12.092 Z M 31.916 12.092"/></svg></dt-button></td>`;if(!0===this.postTypeSettings[s])return e`<td dir="auto" title="${this.postTypeSettings[s].name}">['✓']</td>`}return e`<td dir="auto" title="${this.postTypeSettings[s].name}"></td>`}))}_fieldListIconTemplate(t){return this.postTypeSettings[t].icon?e`<img class="dt-icon" src="${this.postTypeSettings[t].icon}" alt="${this.postTypeSettings[t].name}">`:null}_fieldsListTemplate(){return r(Object.keys(this.postTypeSettings).sort(((t,e)=>{const s=this.postTypeSettings[t].name.toUpperCase(),i=this.postTypeSettings[e].name.toUpperCase();return s<i?-1:s>i?1:0})),(t=>t),(t=>this.postTypeSettings[t].hidden?null:e`<li class="list-field-picker-item"><label><input type="checkbox" id="${t}" name="${t}" .value="${t}" @change="${this._updateFields}" ?checked="${this.columns.includes(t)}"> ${this._fieldListIconTemplate(t)} ${this.postTypeSettings[t].name}</label></li>`))}_fieldsSelectorTemplate(){return this.showFieldsSelector?e`<div id="list_column_picker" class="list_field_picker list_action_section"><div class="list_action_section_header"><p style="font-weight:700">${s("Choose which fields to display as columns in the list")}</p><button class="close-button list-action-close-button" data-close="list_column_picker" aria-label="Close modal" type="button" @click="${this._fieldsEdit}"><span aria-hidden="true">×</span></button></div><ul class="fieldsList">${this._fieldsListTemplate()}</ul></div>`:null}_updateFields(t){const e=t.target.value,s=this.columns;s.includes(e)?(s.filter((t=>t!==e)),s.splice(s.indexOf(e),1)):s.push(e),this.columns=s,this.style.setProperty("--number-of-columns",this.columns.length-1),this.requestUpdate()}_bulkSelectorTemplate(){return this.showBulkEditSelector?e`<div id="bulk_edit_picker" class="list_action_section"><div class="list_action_section_header"><p style="font-weight:700">${s(i`Select all the ${this.postType} you want to update from the list, and update them below`)}</p><button class="close-button list-action-close-button" aria-label="Close modal" type="button" @click="${this._bulkEdit}"><span aria-hidden="true">×</span></button></div><ul class="fieldsList">This is where the bulk edit form will go.</ul></div>`:null}connectedCallback(){super.connectedCallback(),this.payload={sort:this.sortedBy,overall_status:["-closed"],fields_to_return:this.columns},0===this.posts.length&&this._getPosts(this.payload).then((t=>{this.posts=t}))}_handleLoadMore(){this.limit=500,this.payload={sort:this.sortedBy,overall_status:["-closed"],fields_to_return:this.columns,offset:this.offset,limit:this.limit},this.loadMore=!0,this._getPosts(this.payload).then((t=>{console.log(t)}))}render(){const t={bulk_editing:this.showBulkEditSelector,hidden:!1};this.posts&&(this.total=this.posts.length);const o=e`<svg viewBox="0 0 100 100" fill="#000000" style="enable-background:new 0 0 100 100" xmlns="http://www.w3.org/2000/svg"><line style="stroke-linecap:round;paint-order:fill;fill:none;stroke-width:15px" x1="7.97" y1="50.199" x2="76.069" y2="50.128" transform="matrix(0.999999, 0.001017, -0.001017, 0.999999, 0.051038, -0.042708)"/><line style="stroke-linecap:round;stroke-width:15px" x1="7.97" y1="17.751" x2="92.058" y2="17.751"/><line style="stroke-linecap:round;stroke-width:15px" x1="7.97" y1="82.853" x2="42.343" y2="82.853"/><polygon style="stroke-linecap:round;stroke-miterlimit:1;stroke-linejoin:round;fill:#fff;paint-order:stroke;stroke-width:9px" points="22.982 64.982 33.592 53.186 50.916 70.608 82.902 21.308 95 30.85 52.256 95"/></svg>`,r=e`<svg height="100px" width="100px" fill="#000000" xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><g><g i:extraneous="self"><g><path d="M94.4,63c0-5.7-3.6-10.5-8.6-12.5V7.3c0-2.7-2.2-4.8-4.8-4.8c-2.7,0-4.8,2.2-4.8,4.8v43.2c-5,1.9-8.6,6.8-8.6,12.5     s3.6,10.5,8.6,12.5v17.2c0,2.7,2.2,4.8,4.8,4.8c2.7,0,4.8-2.2,4.8-4.8V75.5C90.9,73.6,94.4,68.7,94.4,63z M81,66.7     c-2,0-3.7-1.7-3.7-3.7c0-2,1.7-3.7,3.7-3.7s3.7,1.7,3.7,3.7C84.7,65.1,83.1,66.7,81,66.7z"></path><path d="M54.8,24.5V7.3c0-2.7-2.2-4.8-4.8-4.8c-2.7,0-4.8,2.2-4.8,4.8v17.2c-5,1.9-8.6,6.8-8.6,12.5s3.6,10.5,8.6,12.5v43.2     c0,2.7,2.2,4.8,4.8,4.8c2.7,0,4.8-2.2,4.8-4.8V49.5c5-1.9,8.6-6.8,8.6-12.5S59.8,26.5,54.8,24.5z M50,40.7c-2,0-3.7-1.7-3.7-3.7     c0-2,1.7-3.7,3.7-3.7c2,0,3.7,1.7,3.7,3.7C53.7,39.1,52,40.7,50,40.7z"></path><path d="M23.8,50.5V7.3c0-2.7-2.2-4.8-4.8-4.8c-2.7,0-4.8,2.2-4.8,4.8v43.2c-5,1.9-8.6,6.8-8.6,12.5s3.6,10.5,8.6,12.5v17.2     c0,2.7,2.2,4.8,4.8,4.8c2.7,0,4.8-2.2,4.8-4.8V75.5c5-1.9,8.6-6.8,8.6-12.5S28.8,52.5,23.8,50.5z M19,66.7c-2,0-3.7-1.7-3.7-3.7     c0-2,1.7-3.7,3.7-3.7c2,0,3.7,1.7,3.7,3.7C22.7,65.1,21,66.7,19,66.7z"></path></g></g></g></svg>`;return e`<div class="section"><div class="header"><div class="section-header"><span class="section-header posts-header" style="display:inline-block">${s(i`${this.postTypeLabel?this.postTypeLabel:this.postType} List`)}</span></div><span class="filter-result-text">${s(i`Showing ${this.total} of ${this.total}`)}</span> <button class="bulkToggle toggleButton" id="bulk_edit_button" @click="${this._bulkEdit}">${o} ${s("Bulk Edit")}</button> <button class="fieldsToggle toggleButton" id="fields_edit_button" @click="${this._fieldsEdit}">${r} ${s("Fields")}</button><dt-toggle name="showArchived" label="${s("Show Archived")}" ?checked="${this.showArchived}" hideIcons onchange="${this._toggleShowArchived}" @click="${this._toggleShowArchived}"></dt-toggle></div>${this._fieldsSelectorTemplate()} ${this._bulkSelectorTemplate()}<table class="table-contacts ${a(t)}">${this._headerTemplate()} ${this.posts?this._rowTemplate():s("Loading")}</table>${this.total>=100?e`<div class="text-center"><dt-button buttonStyle="${JSON.stringify({margin:"0"})}" class="loadMoreButton btn btn-primary" @click="${this._handleLoadMore}">Load More</dt-button></div>`:""}</div>`}});
//# sourceMappingURL=dt-list.js.map
